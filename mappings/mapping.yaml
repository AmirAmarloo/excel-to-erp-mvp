source:
  file: "../data/input_data.xlsx"
  sheet: "Sheet1"

columns:
  project_code:
    type: string
    required: true
    unique: false
    pattern: "^PRJ-\\d+$"
    auto_clean: true
    normalize: false
    priority: 3

  customer_code:
    type: string
    required: true
    unique: false
    pattern: "^CUST-\\d+$"
    auto_clean: true
    normalize: false
    priority: 1

  invoice_number:
    type: string
    required: true
    auto_clean: true
    normalize: true
    unique_composite: ["customer_code"]
    priority: 1

  name:
    type: string
    required: true
    unique: false
    min_length: 3
    max_length: 50
    auto_clean: true
    normalize: true
    priority: 2

  status:
    type: string
    required: true
    allowed_values:
      - active
      - pending
      - closed
      - suspend
    auto_clean: true
    normalize: true
    priority: 2

  amount:
    type: float
    required: true
    min_value: 0
    custom_rule: # For conditional logic
      type: conditional
      if_col: status
      equals: suspend
      then_value: 0
    priority: 2

  created_at:
    type: datetime
    required: true
    timezone: UTC
    excel_date: true
    min_year: 2000
    max_year: "current"
    not_future: true
    priority: 3
