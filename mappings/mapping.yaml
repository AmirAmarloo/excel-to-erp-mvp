source:
  file: "../data/input_data.xlsx"
  sheet: "Sheet1"

columns:
  name:
    type: "string"
    priority: 1
    required: true
    auto_clean: true
    pattern: "^[a-zA-Z ]+$"
    # Rule: Name length between 3 and 50
    custom_rule:
      type: "length"
      min: 3
      max: 50

  status:
    type: "string"
    priority: 2
    required: true
    # Rule: Only these status values are allowed
    custom_rule:
      type: "allowed_values"
      list: ["active", "pending", "closed", "suspend"]

  amount:
    type: "float"
    priority: 2
    required: true
    # Rule: If status is 'suspend', amount MUST be 0
    custom_rule:
      type: "conditional"
      if_col: "status"
      equals: "suspend"
      then_value: 0

  created_at:
    type: "datetime"
    timezone: "UTC"
    excel_date: true
    priority: 3
    # Rule: Protect against future dates and weird Excel numbers (like 4654654)
    custom_rule:
      type: "date_range"
      min_year: 2000
      max_year: 2026
      not_future: true
