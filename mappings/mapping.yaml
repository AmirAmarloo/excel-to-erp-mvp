# Configuration for Excel to ERP Validation Engine
source:
  file: "data/sample.xlsx"
  sheet: "Sheet1"

columns:
  customr_id:
    type: int
    required: true
    auto_clean: true
    unique:
      scope: "file"
      case_insensitive: true
      composite_with: [] # Standalone uniqueness
    min_value: 1000
    max_value: 9999
    priority: 1

  name:
    type: string
    required: true
    auto_clean: true
    min_length: 3
    priority: 2

  status:
    type: string
    required: true
    allowed_values: ["Active", "Deactive", "Suspend"]
    priority: 2

  amount:
    type: float
    required: true
    # DSL-based Custom Rule (Case: If status is Suspend, amount must be 0)
    custom_rule:
      type: "conditional"
      if_col: "status"
      equals: "Suspend"
      then_value: 0
    priority: 2

  project_code:
    type: string
    pattern: "^PRJ-[0-9]+$" # Regex validation
    priority: 3

  created_at:
    type: datetime
    timezone: "UTC"
    excel_date: true        # Handles Excel serial date numbers
    # DSL-based Custom Rule (Case: Date cannot be in the future)
    custom_rule:
      type: "compare"
      operator: "<="
      right: "now"
    priority: 3
